{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Prism User Data",
  "description": "Schema for user data.yml - global bug database and project tracking",
  "type": "object",
  "properties": {
    "global_bugs": {
      "type": "object",
      "patternProperties": {
        "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$": {
          "$ref": "#/definitions/global_bug"
        }
      },
      "additionalProperties": false
    },
    "known_projects": {
      "type": "object",
      "patternProperties": {
        "^.+$": {
          "$ref": "#/definitions/project_tracker"
        }
      },
      "additionalProperties": false
    },
    "productivity_stats": {
      "type": "object",
      "patternProperties": {
        "^.+$": {"type": "number"}
      },
      "additionalProperties": false
    }
  },
  "required": ["global_bugs", "known_projects", "productivity_stats"],
  "additionalProperties": false,
  "definitions": {
    "global_bug": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "title": {"type": "string", "minLength": 1},
        "description": {"type": "string"},
        "severity": {"type": "string", "enum": ["critical", "high", "medium", "low", "trivial"]},
        "status": {"type": "string", "enum": ["open", "in_progress", "resolved", "closed", "wontfix", "duplicate"]},
        "tags": {"type": "array", "items": {"type": "string"}, "uniqueItems": true},
        "source_project": {"type": "string"},
        "original_bug_id": {"type": "string", "format": "uuid"},
        "category": {"type": "string"},
        "pattern_tags": {"type": "array", "items": {"type": "string"}, "uniqueItems": true},
        "resolution_notes": {"type": "string"},
        "resolution_project": {"type": ["string", "null"]},
        "related_bugs": {"type": "array", "items": {"type": "string", "format": "uuid"}, "uniqueItems": true},
        "created_at": {"type": "string", "format": "date-time"},
        "updated_at": {"type": "string", "format": "date-time"}
      },
      "required": ["id", "title", "severity", "status", "tags", "source_project", "original_bug_id", "created_at", "updated_at"],
      "additionalProperties": false
    },
    "project_tracker": {
      "type": "object",
      "properties": {
        "path": {"type": "string"},
        "name": {"type": "string"},
        "last_accessed": {"type": "string", "format": "date-time"},
        "total_time_tracked_seconds": {"type": "number", "minimum": 0},
        "bug_count": {"type": "integer", "minimum": 0},
        "task_count": {"type": "integer", "minimum": 0}
      },
      "required": ["path", "name", "last_accessed", "total_time_tracked_seconds", "bug_count", "task_count"],
      "additionalProperties": false
    }
  }
}