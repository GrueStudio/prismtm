{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Prism Project Configuration",
  "type": "object",
  "required": ["project", "phases", "settings", "meta"],
  "properties": {
    "project": {
      "type": "object",
      "required": ["name", "created"],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100
        },
        "created": {
          "type": "string",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "maxLength": 500
        }
      }
    },
    "phases": {
      "type": "object",
      "required": ["current", "definitions"],
      "properties": {
        "current": {
          "type": "string",
          "enum": ["pre_alpha", "alpha", "beta", "release"]
        },
        "definitions": {
          "type": "object",
          "required": ["pre_alpha", "alpha", "beta", "release"],
          "properties": {
            "pre_alpha": { "$ref": "#/definitions/phase_definition" },
            "alpha": { "$ref": "#/definitions/phase_definition" },
            "beta": { "$ref": "#/definitions/phase_definition" },
            "release": { "$ref": "#/definitions/phase_definition" }
          }
        }
      }
    },
    "settings": {
      "type": "object",
      "properties": {
        "auto_start_timer": { "type": "boolean", "default": true },
        "time_tracking_enabled": { "type": "boolean", "default": true },
        "backup_enabled": { "type": "boolean", "default": true },
        "backup_frequency": {
          "type": "string",
          "enum": ["daily", "weekly", "manual"],
          "default": "daily"
        },
        "track_bugs_globally": { "type": "boolean", "default": true },
        "auto_orphan_bug_fixes": { "type": "boolean", "default": true },
        "display": {
          "type": "object",
          "properties": {
            "show_time_in_status": { "type": "boolean", "default": true },
            "show_completed_items": { "type": "boolean", "default": true },
            "default_status_filter": {
              "type": "string",
              "enum": ["all", "current_and_future", "current_only"],
              "default": "current_and_future"
            },
            "tree_icons": { "type": "boolean", "default": true },
            "color_coding": { "type": "boolean", "default": true }
          }
        },
        "time": {
          "type": "object",
          "properties": {
            "minimum_session": { 
              "type": "integer", 
              "minimum": 0, 
              "maximum": 3600,
              "default": 60 
            },
            "auto_pause_after": { 
              "type": "integer", 
              "minimum": 300, 
              "maximum": 86400,
              "default": 1800 
            },
            "round_to_minutes": { "type": "boolean", "default": true }
          }
        }
      }
    },
    "meta": {
      "type": "object",
      "required": ["schema_version", "created_by", "last_modified"],
      "properties": {
        "schema_version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "created_by": { "type": "string" },
        "last_modified": {
          "type": "string",
          "format": "date-time"
        },
        "last_backup": {
          "type": "string",
          "format": "date-time"
        }
      }
    }
  },
  "definitions": {
    "phase_definition": {
      "type": "object",
      "required": ["version_pattern", "description"],
      "properties": {
        "version_pattern": { "type": "string" },
        "description": { "type": "string" }
      }
    }
  }
}
